env:
    CIRRUS_CLONE_DEPTH: 1
    BUILD_HOSTNAME: "halium"

task:
  name: Build
  timeout_in: 8760h
  persistent_worker:
    isolation:
      container:
        image: dopaemon/bionic:latest
        cpu: 4
        memory: 8G
        volumes:
          - /home/doraemon/HDD/CI/roms:/home/doraemon/HDD/CI/roms
          - /home/doraemon/HDD/CI/ccache:/home/doraemon/HDD/CI/ccache

  info_script:
    - lscpu
  repo_sync_script:
    - cd /home/doraemon/HDD/CI/roms/halium/9
    - repo init -q --no-repo-verify --depth=1 -u https://github.com/halium/android.git -b halium-9.0 -g default,-device,-mips,-darwin,-notdefault
    - repo sync -v -c --no-clone-bundle --no-tags --optimized-fetch --prune --force-sync -j$(nproc --all) || repo sync -v -c --no-clone-bundle --no-tags --optimized-fetch --prune --force-sync -j$(nproc --all)
